(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{100:function(e,t,n){"use strict";(function(e,t){var r=n(4);n(26),n(27);r(n(25));var o=r(n(101));e.__webpack_require_UNI_MP_PLUGIN__=n,t(o.default)}).call(this,n(1)["default"],n(2)["createPage"])},101:function(e,t,n){"use strict";n.r(t);var r=n(102),o=n(104);for(var s in o)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(s);n(106);var a,i=n(44),c=Object(i["default"])(o["default"],r["render"],r["staticRenderFns"],!1,null,"b237504c",null,!1,r["components"],a);c.options.__file="pages/login/login.vue",t["default"]=c.exports},102:function(e,t,n){"use strict";n.r(t);var r=n(103);n.d(t,"render",(function(){return r["render"]})),n.d(t,"staticRenderFns",(function(){return r["staticRenderFns"]})),n.d(t,"recyclableRender",(function(){return r["recyclableRender"]})),n.d(t,"components",(function(){return r["components"]}))},103:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"render",(function(){return o})),n.d(t,"staticRenderFns",(function(){return a})),n.d(t,"recyclableRender",(function(){return s})),n.d(t,"components",(function(){return r}));var o=function(){var e=this,t=e.$createElement;e._self._c},s=!1,a=[];o._withStripped=!0},104:function(e,t,n){"use strict";n.r(t);var r=n(105),o=n.n(r);for(var s in r)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(s);t["default"]=o.a},105:function(e,t,n){"use strict";(function(e,r){var o=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=o(n(28)),a=o(n(31)),i=o(n(11)),c=n(49),u=n(46);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){(0,i.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d={data:function(){return{phone:"13587670732",password:"1",confirmPassword:"",isRegistering:!1,isLoggedIn:!1}},methods:f(f(f({},(0,c.mapGetters)(["isLogin"])),(0,c.mapMutations)(["SET_MEMBER"])),{},{toggleRegister:function(){this.isRegistering=!this.isRegistering},login:function(){var t=this;return(0,a.default)(s.default.mark((function n(){var o;return s.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.phone&&t.password){n.next=3;break}return e.showToast({title:"手机号和密码不能为空",icon:"none"}),n.abrupt("return");case 3:return n.prev=3,n.next=6,r.callFunction({name:"validateUser",data:{phone:t.phone,password:t.password}});case 6:o=n.sent,o.result.success?(Object.assign(u.Member,o.result.user),t.SET_MEMBER(o.result.user),e.showToast({title:"登录成功",icon:"success"}),e.navigateBack()):e.showToast({title:"手机号或密码不正确，请重新输入",icon:"none"}),n.next=14;break;case 10:n.prev=10,n.t0=n["catch"](3),console.error("登录失败",n.t0),e.showToast({title:"登录失败",icon:"none"});case 14:case"end":return n.stop()}}),n,null,[[3,10]])})))()},register:function(){var t=this;return(0,a.default)(s.default.mark((function n(){var o,a,i,c,l,f,d,p;return s.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.phone&&t.password&&t.confirmPassword){n.next=3;break}return e.showToast({title:"手机号、密码和确认密码不能为空",icon:"none"}),n.abrupt("return");case 3:if(t.password===t.confirmPassword){n.next=6;break}return e.showToast({title:"两次密码输入不一致",icon:"none"}),n.abrupt("return");case 6:if(o=/^[1][3-9][0-9]{9}$/,o.test(t.phone)){n.next=10;break}return e.showToast({title:"手机号格式不正确",icon:"none"}),n.abrupt("return");case 10:return n.prev=10,n.next=13,r.callFunction({name:"checkPhoneExist",data:{phone:t.phone}});case 13:if(a=n.sent,!a.result.exists){n.next=17;break}return e.showToast({title:"手机号已被注册",icon:"none"}),n.abrupt("return");case 17:return i=new Date,c=Math.floor(i.getTime()/1e3),l=i.toISOString().replace("T"," ").slice(0,19),f="USR".concat(c),d={_id:f,mobilePhone:t.phone,avatar:"/static/images/mine/default.png",cardName:"V0",memberLevel:1,birthday:"",pointNum:0,balance:0,needValue:9999999,orders:[],nickname:t.phone,openingCardDate:l,password:t.password},n.next=24,r.callFunction({name:"registerUser",data:{newUser:d}});case 24:p=n.sent,p.result.success?(Object.assign(u.Member,d),t.SET_MEMBER(d),t.isRegistering=!1,e.showToast({title:"注册成功",icon:"success"})):e.showToast({title:"注册失败",icon:"none"}),n.next=32;break;case 28:n.prev=28,n.t0=n["catch"](10),console.error("注册失败",n.t0),e.showToast({title:"注册失败",icon:"none"});case 32:case"end":return n.stop()}}),n,null,[[10,28]])})))()}})};t.default=d}).call(this,n(2)["default"],n(27)["default"])},106:function(e,t,n){"use strict";n.r(t);var r=n(107),o=n.n(r);for(var s in r)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(s);t["default"]=o.a},107:function(e,t,n){}},[[100,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/login/login.js.map