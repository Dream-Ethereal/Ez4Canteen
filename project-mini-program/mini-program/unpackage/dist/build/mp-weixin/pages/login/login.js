(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{1344:function(e,t,n){},"17bb":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var r=function(){var e=this.$createElement;this._self._c},a=[]},"3f06":function(e,t,n){"use strict";n.r(t);var r=n("ea8d"),a=n.n(r);for(var o in r)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(o);t["default"]=a.a},"52e9":function(e,t,n){"use strict";(function(e,t){var r=n("47a9");n("e392"),n("861b");r(n("3240"));var a=r(n("98a2"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(a.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},"98a2":function(e,t,n){"use strict";n.r(t);var r=n("17bb"),a=n("3f06");for(var o in a)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(o);n("b898");var s=n("828b"),i=Object(s["a"])(a["default"],r["b"],r["c"],!1,null,"dbc7a33c",null,!1,r["a"],void 0);t["default"]=i.exports},b898:function(e,t,n){"use strict";var r=n("1344"),a=n.n(r);a.a},ea8d:function(e,t,n){"use strict";(function(e,r){var a=n("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n("7eb4")),s=a(n("ee10")),i=a(n("7ca3")),c=n("8f59"),u=n("c2d6");function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){(0,i.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d={data:function(){return{phone:"13587670732",password:"1",confirmPassword:"",isRegistering:!1,isLoggedIn:!1}},methods:f(f(f({},(0,c.mapGetters)(["isLogin"])),(0,c.mapMutations)(["SET_MEMBER"])),{},{toggleRegister:function(){this.isRegistering=!this.isRegistering},login:function(){var t=this;return(0,s.default)(o.default.mark((function n(){var a;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.phone&&t.password){n.next=3;break}return e.showToast({title:"手机号和密码不能为空",icon:"none"}),n.abrupt("return");case 3:return n.prev=3,n.next=6,r.callFunction({name:"validateUser",data:{phone:t.phone,password:t.password}});case 6:a=n.sent,a.result.success?(Object.assign(u.Member,a.result.user),t.SET_MEMBER(a.result.user),e.showToast({title:"登录成功",icon:"success"}),e.navigateBack()):e.showToast({title:"手机号或密码不正确，请重新输入",icon:"none"}),n.next=14;break;case 10:n.prev=10,n.t0=n["catch"](3),console.error("登录失败",n.t0),e.showToast({title:"登录失败",icon:"none"});case 14:case"end":return n.stop()}}),n,null,[[3,10]])})))()},register:function(){var t=this;return(0,s.default)(o.default.mark((function n(){var a,s,i,c,l,f,d,p;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.phone&&t.password&&t.confirmPassword){n.next=3;break}return e.showToast({title:"手机号、密码和确认密码不能为空",icon:"none"}),n.abrupt("return");case 3:if(t.password===t.confirmPassword){n.next=6;break}return e.showToast({title:"两次密码输入不一致",icon:"none"}),n.abrupt("return");case 6:if(a=/^[1][3-9][0-9]{9}$/,a.test(t.phone)){n.next=10;break}return e.showToast({title:"手机号格式不正确",icon:"none"}),n.abrupt("return");case 10:return n.prev=10,n.next=13,r.callFunction({name:"checkPhoneExist",data:{phone:t.phone}});case 13:if(s=n.sent,!s.result.exists){n.next=17;break}return e.showToast({title:"手机号已被注册",icon:"none"}),n.abrupt("return");case 17:return i=new Date,c=Math.floor(i.getTime()/1e3),l=i.toISOString().replace("T"," ").slice(0,19),f="USR".concat(c),d={_id:f,mobilePhone:t.phone,avatar:"/static/images/mine/default.png",cardName:"V0",memberLevel:1,birthday:"",pointNum:0,balance:0,needValue:9999999,orders:[],nickname:t.phone,openingCardDate:l,password:t.password},n.next=24,r.callFunction({name:"registerUser",data:{newUser:d}});case 24:p=n.sent,p.result.success?(Object.assign(u.Member,d),t.SET_MEMBER(d),t.isRegistering=!1,e.showToast({title:"注册成功",icon:"success"})):e.showToast({title:"注册失败",icon:"none"}),n.next=32;break;case 28:n.prev=28,n.t0=n["catch"](10),console.error("注册失败",n.t0),e.showToast({title:"注册失败",icon:"none"});case 32:case"end":return n.stop()}}),n,null,[[10,28]])})))()}})};t.default=d}).call(this,n("df3c")["default"],n("861b")["default"])}},[["52e9","common/runtime","common/vendor"]]]);